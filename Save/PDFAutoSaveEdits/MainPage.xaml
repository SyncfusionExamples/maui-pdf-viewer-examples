<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pdfViewer="clr-namespace:Syncfusion.Maui.PdfViewer;assembly=Syncfusion.Maui.PdfViewer"
             x:Class="PDFAutoSaveEdits.MainPage">
    <ContentPage.Resources>
        <ResourceDictionary>
            <Style x:Key="ToolbarButtonStyle"
                   TargetType="Button">
                <Setter Property="CornerRadius"
                        Value="6" />
                <Setter Property="Padding"
                        Value="10,6" />
                <Setter Property="Margin"
                        Value="5,0" />
                <Setter Property="BackgroundColor"
                        Value="#3B82F6" />
                <Setter Property="TextColor"
                        Value="White" />
                <Setter Property="FontAttributes"
                        Value="Bold" />
                <!-- Visual states -->
                <Setter Property="VisualStateManager.VisualStateGroups">
                    <VisualStateGroupList>
                        <VisualStateGroup Name="CommonStates">
                            <VisualState Name="Normal" />
                            <VisualState Name="Disabled">
                                <VisualState.Setters>
                                    <!-- Muted gray background -->
                                    <Setter Property="BackgroundColor"
                                            Value="#E5E7EB" />

                                    <!-- Dark gray text for strong contrast -->
                                    <Setter Property="TextColor"
                                            Value="#1F2937" />
                                </VisualState.Setters>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateGroupList>
                </Setter>
            </Style>


            <Style x:Key="NotificationLabelStyle"
                   TargetType="Label">
                <Setter Property="TextColor"
                        Value="#059669" />
                <Setter Property="FontSize"
                        Value="Medium" />
                <Setter Property="IsVisible"
                        Value="False" />
                <Setter Property="Opacity"
                        Value="0" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowSpacing="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Top toolbar -->
        <Border Grid.Row="0"
                BackgroundColor="#F3F4F6"
                Padding="12"
                StrokeThickness="0">
            <Grid ColumnSpacing="12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Notification Label -->
                <Label Grid.Column="0"
                       x:Name="NotificationLabel"
                       Text="{Binding NotficationText}"
                       HorizontalOptions="Start"
                       VerticalOptions="Center" />
                <HorizontalStackLayout Grid.Column="1">
                    <!-- Open File Button -->
                    <Button x:Name="OpenButton"
                            Text="&#xe712;"
                            FontSize="20"
                            ToolTipProperties.Text="Open PDF file"
                            FontFamily="MauiMaterialAssets"
                            VerticalOptions="Center"
                            Style="{StaticResource ToolbarButtonStyle}"
                            Command="{Binding OpenPdfCommand}" />

                    <!-- Save File Button -->
                    <Button Grid.Column="1"
                            x:Name="SaveButton"
                            FontSize="20"
                            Text="&#xe75f;"
                            VerticalOptions="Center"
                            FontFamily="MauiMaterialAssets"
                            ToolTipProperties.Text="Save PDF file"
                            Style="{StaticResource ToolbarButtonStyle}"
                            Command="{Binding SavePdfCommand}"
                            IsEnabled="{Binding IsAutoSaveEnabled, Converter={StaticResource InverseBooleanConverter}}"/>

                    <!-- AutoSave Toggle -->
                    <Border 
                        StrokeThickness="1" Padding="0,0,12,0" 
                        Margin="4,0" Stroke="LightGray"
                            VerticalOptions="Center">
                        <StackLayout Orientation="Horizontal"
                                     VerticalOptions="Center">
                            <CheckBox IsChecked="{Binding IsAutoSaveEnabled}"
                                      VerticalOptions="Center" />
                            <Label Text="Auto Save"
                                   VerticalOptions="Center" />
                        </StackLayout>
                    </Border>
                </HorizontalStackLayout>
            </Grid>
        </Border>

        <!-- PDF Viewer -->
        <pdfViewer:SfPdfViewer 
            Grid.Row="1"
            x:Name="PdfViewer"
            DocumentLoaded="PdfViewer_DocumentLoaded"
            DocumentUnloaded="PdfViewer_DocumentUnloaded"
            AnnotationAdded="PdfViewer_AnnotationAdded"
            AnnotationRemoved="PdfViewer_AnnotationRemoved"
            AnnotationEdited="PdfViewer_AnnotationEdited"
            FormFieldValueChanged="PdfViewer_FormFieldValueChanged"/>
    </Grid>
</ContentPage>
