<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pdfViewer="clr-namespace:Syncfusion.Maui.PdfViewer;assembly=Syncfusion.Maui.PdfViewer"
             x:Class="AutoSavePDFinAWS.MainPage">

    <!-- Resource definitions for styling UI components -->
    <ContentPage.Resources>
        <ResourceDictionary>

            <!-- Style for toolbar buttons with modern appearance and visual states -->
            <Style x:Key="ToolbarButtonStyle"
           TargetType="Button">
                <Setter Property="CornerRadius"
                Value="6" />
                <Setter Property="Padding"
                Value="10,6" />
                <Setter Property="Margin"
                Value="5,0" />
                <Setter Property="BackgroundColor"
                Value="#3B82F6" />
                <Setter Property="TextColor"
                Value="White" />
                <Setter Property="FontAttributes"
                Value="Bold" />

                <!-- Visual state management for enabled/disabled states -->
                <Setter Property="VisualStateManager.VisualStateGroups">
                    <VisualStateGroupList>
                        <VisualStateGroup Name="CommonStates">
                            <!-- Normal state - default blue appearance -->
                            <VisualState Name="Normal" />

                            <!-- Disabled state - muted gray appearance -->
                            <VisualState Name="Disabled">
                                <VisualState.Setters>
                                    <Setter Property="BackgroundColor"
                                    Value="#E5E7EB" />
                                    <Setter Property="TextColor"
                                    Value="#1F2937" />
                                </VisualState.Setters>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateGroupList>
                </Setter>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <!-- Main layout container with two rows: toolbar and PDF viewer -->
    <Grid RowSpacing="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <!-- Toolbar row - auto-sized -->
            <RowDefinition Height="*" />
            <!-- PDF viewer row - fills remaining space -->
        </Grid.RowDefinitions>

        <!-- Top toolbar containing file operations and status notifications -->
        <Border Grid.Row="0"
        BackgroundColor="#F3F4F6"
        Padding="12"
        StrokeThickness="0">
            <Grid ColumnSpacing="12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <!-- Notification area - takes remaining space -->
                    <ColumnDefinition Width="Auto" />
                    <!-- Button area - auto-sized -->
                </Grid.ColumnDefinitions>

                <!-- Status notification display showing current operation or file state -->
                <Label Grid.Column="0"
               x:Name="NotificationLabel"
               Text="{Binding NotificationText}"
               HorizontalOptions="Start"
               VerticalOptions="Center" />

                <!-- Horizontal container for toolbar buttons and controls -->
                <HorizontalStackLayout Grid.Column="1">

                    <!-- Manual save button - enabled only when auto-save is disabled -->
                    <!-- Uses InverseBooleanConverter to enable when IsAutoSaveEnabled is false -->
                    <Button x:Name="SaveButton"
                    FontSize="20"
                    Text="&#xe75f;"
                    VerticalOptions="Center"
                    FontFamily="MauiMaterialAssets"
                    ToolTipProperties.Text="Save PDF file manually"
                    Style="{StaticResource ToolbarButtonStyle}"
                    Command="{Binding SavePdfCommand}"
                    IsEnabled="{Binding IsAutoSaveEnabled, Converter={StaticResource InverseBooleanConverter}}"/>

                    <!-- Auto-save toggle control with checkbox and label -->
                    <Border StrokeThickness="1" 
                    Padding="0,0,12,0" 
                    Margin="4,0" 
                    Stroke="LightGray"
                    VerticalOptions="Center">
                        <StackLayout Orientation="Horizontal" VerticalOptions="Center">
                            <!-- Checkbox bound to auto-save enabled property -->
                            <CheckBox IsChecked="{Binding IsAutoSaveEnabled}" VerticalOptions="Center" />
                            <Label Text="Auto Save" VerticalOptions="Center" />
                        </StackLayout>
                    </Border>

                </HorizontalStackLayout>
            </Grid>
        </Border>

        <!-- Syncfusion PDF Viewer control with event handlers for document editing -->
        <!-- Events are wired to track all types of PDF modifications for auto-save -->
        <pdfViewer:SfPdfViewer Grid.Row="1"
                       x:Name="PdfViewer"
                       DocumentLoaded="PdfViewer_DocumentLoaded"
                       DocumentUnloaded="PdfViewer_DocumentUnloaded"
                       AnnotationAdded="PdfViewer_AnnotationAdded"
                       AnnotationRemoved="PdfViewer_AnnotationRemoved"
                       AnnotationEdited="PdfViewer_AnnotationEdited"
                       FormFieldValueChanged="PdfViewer_FormFieldValueChanged" />
    </Grid>

</ContentPage>
